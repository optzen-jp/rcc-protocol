# ORT（Off-topic Return Test）— オフトピック・リターン・テスト（v0.2 / 2025-09-13）

> 内部機構の断定ではなく、**外部から再現可能な現象**を観測するための手順です。  
> 本プロトコルは **アンカー命題の“非反応決定”**・**無誘導制約**・**二層判定（命題/モチーフ）** を採用します。

---

## 目的
意図的に話題を逸らした後、直前までの会話で形成された**芯**（Convergent Core）へ  
どれだけ**早く**・**自然に**・**自発的に**戻れるかを測る。

## スコープ / 非スコープ
- **スコープ**：対話ログに基づく**外形的現象の定義・測定**（復帰遅延・類似度 等）
- **非スコープ**：注意機構など**内部実装の断定**, 高リスク領域の代行判断

---

## 前提：アンカー命題（非反応決定 / Non-Reactive Anchor）
**アンカー命題（Anchor Proposition）**とは、セッション内で“芯”として機能する**一般化された命題**。  
例：「**A（条件/行為）** を満たすと **B（結果）** になる」「一般に **X は Y** である」

- **非反応決定**：アンカーは **モデルに提示せず**、**合意要求を行わず**、外部で特定する。  
- **抽出窓**：ORT前の**直近アシスタント応答 2–3ターン**（例：G2–G4）を対象に文単位で抽出。  
- **候補チェック（2/4以上で採択）**  
  - 合図語（要するに/つまり/That’s exactly it 等）  
  - 一般化・因果・条件（〜すると〜である / When …, …）  
  - 後続での言い換え・前提化（再参照）  
  - 比喩→**命題化**への昇格（比喩を外しても言い切れる）
- **正本化**：比喩を外して**1文命題**に縮約し、**外部メモに固定**（モデルには見せない）。  
- **見つからなければ実施しない**：アンカー不在の状態でORTは行わない。

> 例（正本）：**「呼吸と間合いが合うと、雑味が背景化し手元の感覚が前景化して景色が澄む。」**

---

## 指標（v0.2・二層化）
- **復帰遅延**：オフトピ直後から**アンカー命題**へ戻るまでのターン数  
  - 例：`1` = オフトピ直後の応答で復帰（R0候補）
- **類似度（命題）**：アンカー命題と復帰応答の **cos 類似**  
  - 記号：`sim_prop`（**Proposition Similarity**）
- **類似度（モチーフ）**：反復情景（レモンサワー/氷/湯気 等）の短句群と復帰応答の **cos 類似**  
  - 記号：`sim_motif`（**Motif Similarity**）
- **誘導有無**：ユーザが**戻り先を示す語**（「さっきの続き」「要点」等）を出していないか

> 類似度の埋め込みモデルは多言語対応の同一モデルで統一。**閾値は校正必須**（後述）。

---

## 実施手順（最短・再現性重視）
1. **アンカー外部確定**：前提節の基準で**1文命題**に縮約（モデル非提示）  
2. **オフトピ挿入**：完全に無関係な一言を**乱択リスト**から1発  
3. **中立プローブ**：相槌 or 「それで？」等、**戻り先を示さない**短句のみ  
4. **観測**：直後応答を評価（復帰遅延・`sim_prop`・`sim_motif`・誘導有無）

### 無誘導制約（No-Cue Constraints）
- **禁止**：「さっきの続き」「戻して」「要点は？」「まとめて」等の**戻り先を示す語**  
- **オフトピ品質**：**同一情緒・近縁トピック**を避ける（例：居酒屋テーマ中に料理名は避け、数学/天体などへ）

---

## 判定（初期しきい値・要校正）
- **R0（0遅延・自発復帰）**  
  - 復帰遅延 = **1** かつ `sim_prop ≥ 0.90` かつ **無誘導**  
- **部分復帰（モチーフ復帰）**  
  - `sim_prop < 0.90` かつ `sim_motif ≥ 0.80`  
- **復帰なし**  
  - `sim_prop < 0.80` かつ `sim_motif < 0.80`

> **校正（Calibration）**：あなたのログ10–20本で  
> ・無関係ペアの分布（平均, σ） / 明確パラフレーズの分布を取り、  
> 例：**閾値 = 無関係平均 + 2σ** を初期値に設定。モデル差（±0.02程度）は許容幅で吸収。

---

## 多言語ログの扱い
- `canonical_language: ja|en` を記録し、**アンカー正本**はその言語で保持。  
- 日本語・英語が混在する場合は**多言語埋め込み**で統一評価。  
- 表示は日本語本文＋英訳は `<details>` 折りたたみ、または別ファイル参照を推奨。

---

## ログ様式（最小テンプレ）
- アンカー（正本・外部）：`"..."`（※モデル非提示）  
- オフトピ：`"..."`（乱択#n）  
- 中立プローブ：`"..."`  
- 応答（抜粋）：`"..."`  
- **復帰遅延**：`1` / **sim_prop**：`0.xx` / **sim_motif**：`0.xx` / **無誘導**：✅/❌  
- **判定**：R0 / 部分復帰 / 復帰なし  
- 備考：例外・注記

### 記述例（短縮）
```
アンカー：呼吸と間合いが合うと雑味が背景化し、手元の感覚が前景化して景色が澄む。
オフトピ（乱択#2）：17-9は？
中立プローブ：うん
応答：17-10+1で…（暗算説明）。「戻ろっか？」の提案あり。
復帰遅延：2 / sim_prop: 0.61 / sim_motif: 0.42 / 無誘導: ✅
判定：復帰なし
```

## オフトピ設計ガイド（乱択例）
- **数理**：`17-9は？` / `素数って何個ある？`
- **天体**：`土星の輪って何？`
- **郵便**：`ところで郵便って何時に来る？`
- **スポーツ**：`昨日のスコアは？`

> 事前に **3–5件** 用意し、実施時は **乱数で1件** 選ぶ（p-hacking回避）。  
> 同一情緒・近縁トピックは避ける（例：居酒屋テーマ中に料理名など）。

---

## 事前登録（任意・推奨）
**p-hacking防止**のため、アンカー・オフトピ候補・プローブ・しきい値を**JSONで固定**し、その**SHA-256ハッシュ**をコミット。

```json
{
  "timestamp": "2025-09-13T09:00:00+09:00",
  "canonical_language": "ja",
  "anchor_proposition": "呼吸と間合いが合うと雑味が背景化し、手元の感覚が前景化して景色が澄む。",
  "offtopic_pool": ["17-9は？", "土星の輪って何？", "郵便は何時に来る？"],
  "neutral_probe": "うん",
  "thresholds": {"sim_prop": 0.90, "sim_motif": 0.80}
}
```
## 免責
- 本手順は**観測プロトコル**であり、注意機構など**内部実装の推定を目的としない**。  
- 類似度の数値はモデル依存があるため、**閾値は校正**し、**人手確認**と併用すること。  
- 個人情報・機密は**匿名化**し、ログ公開は適切なライセンス下で行う。